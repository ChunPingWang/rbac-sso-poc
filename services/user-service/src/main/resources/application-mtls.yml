# ==============================================================================
# User Service - mTLS Configuration
#
# 說明：啟用雙向 TLS 認證的配置檔
# 啟用方式：SPRING_PROFILES_ACTIVE=mtls 或 --spring.profiles.active=mtls
#
# 憑證來源：cert-manager 自動掛載到 /etc/ssl/certs/
# ==============================================================================

# SSL Bundle 配置 (Spring Boot 3.1+)
spring:
  ssl:
    bundle:
      pem:
        mtls:
          keystore:
            certificate: /etc/ssl/certs/tls.crt
            private-key: /etc/ssl/certs/tls.key
          truststore:
            certificate: /etc/ssl/certs/ca.crt

server:
  port: 8082
  ssl:
    enabled: true
    bundle: mtls
    client-auth: need
    enabled-protocols: TLSv1.3,TLSv1.2

# 健康檢查 (使用獨立的 HTTP 端口供 K8s 探針使用)
management:
  server:
    port: 8092
    ssl:
      enabled: false  # 明確禁用管理端口的 SSL
  endpoints:
    web:
      exposure:
        include: health,info,metrics

logging:
  level:
    javax.net.ssl: DEBUG
    org.springframework.security: DEBUG
